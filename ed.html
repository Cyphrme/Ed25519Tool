<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>ed25519</title>

	<script src="app.js"></script>
	<script src="noble-ed25519.js"></script>


	<style>
		* {
			font-family: 'Ubuntu Mono', monospace;
		}

		.grid-container {
			display: grid;
			grid-template-columns: 130px auto;
			row-gap: 10px;
			align-items: center;
		}


		select,
		button {
			font-size: 100%;
		}

		#ValidSignature {
			font-weight: bold;
			font-size: 150%;
		}
	</style>

</head>

<body>
	<h1>Ed25519 Sign or Verify</h1>
	<h2>In</h2>
	<hr>


	<div class="grid-container">

		<label for="InputMsg">
			âœ‰ï¸ Message:
		</label>
		<div>
			<textarea name="InputMsg" id="InputMsg" cols="50" rows="3"></textarea>
			<br>
			<label for="InputMsg">
				<select name="MsgEncoding" id="MsgEncoding">
					<option value="Text">Text (UTF-8)</option>
					<option value="Hex">Hex</option>
					<option value="B64">base64</option>
				</select>

				<select name="EdType" id="EdType">
					<option value="Msg">Message ("pure")</option>
					<option value="Dig">Digest ("ph")</option>
				</select>
			</label>
		</div>

		<p></p>
		<div>
			<button id="SignBtn">ğŸ” Sign</button>
			<button title="Verify current signature, message, and public key." id="VerifyBtn">âœ… Verify</button>
			<span id="ValidSignature"></span>
		</div>
	</div>


	<br><br>

	<div class="grid-container">
		<label for="KeyOpts"></label>
		<div>
			<select name="KeyOpts" id="KeyOpts">
				<option value="Hex">Hex</option>
				<option value="B64">base64</option>
			</select>
			<button class="item-3" id="GenRandKeyPairBtn">ğŸ² Gen Random</button>
			<button class="item-4" id="GenKeyPairBtn">ğŸŒ± Gen from Seed</button>
		</div>
		<label for="Seed">ğŸŒ± Seed (Private Key): </label>
		<div>
			<input type="text" id="Seed" size="64">
		</div>
		<label for="PublicKey">ğŸ”‘ Public Key: </label>
		<div>
			<input type="text" id="PublicKey" size="64">
		</div>
		<label for="Signature">âœï¸ Signature: </label>
		<div>
			<input type="text" id="Signature" size="128">
		</div>
	</div>



	<br>


	<h2>Out</h2>
	<hr>



	<div id="Hex">
		<h3>Hex</h3>
		<div class="grid-container">
			<label for="SedHex">Seed: </label>
			<span id="SedHex"></span>
			<label for="PukHex">Public Key: </label>
			<span id="PukHex"></span>
			<label for="KypHex">Seed || Public: </label>
			<span id="KypHex"></span>
			<label for="OSigHex">Signature: </label>
			<span id="OSigHex"></span>
		</div>
	</div>


	<div id="Base64">
		<h3>base64</h3>
		<div class="grid-container">
			<label for="Sed64">Seed: </label>
			<span id="Sed64"></span>
			<label for="Puk64">Public Key: </label>
			<span id="Puk64"></span>
			<label for="KypB64">Seed || Public: </label>
			<span id="Kyp64"></span>
			<label for="OSig64">Signature: </label>
			<span id="OSig64"></span>
		</div>
	</div>

	<br><br><br><br>

	<footer>
		<hr>
		<div>
			<p>
				Input with `Message ("pure")` option uses PureEdDSA without pre-hashing the message. <br>
				Input with `Digest ("ph")` is HashEdDSA (Ed25519ph) and expects input to be a pre-hashed (SHA-512) digest.
			</p><br>

			<hr>
			<h3> Naming Differences in Implementations </h3>
			<p>
				Many libraries, including this tool, refer to what the RFC calls "private key" as the "seed" (like <a href="https://pkg.go.dev/crypto/ed25519">Go</a>).
				The 32 byte seed is used to generate  the private component, the public key,  and the "prefix".
				<br>
				What some libraries call the "private key" (64 bytes) is the seed (32 bytes) concatenated with the public key (32 bytes).
				(Caching the public key precludes relatively slow regeneration when signing.)
				<br>

				The <a href="https://github.com/paulmillr/noble-ed25519/blob/ffdc7026d70297754a825f6e991426188891d1de/index.ts#L903">"actual" private</a>
				component (<a href="https://datatracker.ietf.org/doc/html/rfc8032#section-5.1.5">"secret scalar s" as named by the RFC (Section 5.1.5.3)</a>)
				is typically regenerated from seed on signing. The public component is computed from "secret scalar s", but the "prefix" (nounce) is generated
				from seed and is used for signing and is also typically regenerated on signing.

				<br>
				NaCL used to return the the private key as the "secret scalar s" with the "prefix". Instead of doing that most libraries simply regenerate 
				both secret scalar s and prefix from seed, and optionally cache public key.
			</p>

			<h3> Links </h3>
			<p> <a href="https://cyphr.me/ed25519_applet/ed.html">Link to this page.</a></p>
			<p><a href="https://github.com/cyphrme/ed25519_applet">This page's code.</a></p>
			<br>
			<p> See also: </p>
			<p> <a href="https://tweetnacl.js.org/#/sign">Javascript TweetNaCL tool </a> </p>
			<p> <a href="https://paulmillr.com/noble">Noble Ed25519 tool (at the bottom of that page)</a> </p>
			<p><a href="https://github.com/paulmillr/noble-ed25519">Implemented with the noble/ed25519 library.</a>
				<p><a href="https://blog.mozilla.org/warner/2011/11/29/ed25519-keys"> Blog on Ed25519</a></p>
			</p>
		</div>
	</footer>

</body>

</html>