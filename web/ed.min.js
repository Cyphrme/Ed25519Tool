var Ht={};var B=BigInt(0),y=BigInt(1),I=BigInt(2),at=BigInt(255),ut=I**BigInt(252)+BigInt("27742317777372353535851937790883648493"),p={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:I**at-BigInt(19),l:ut,n:ut,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")},ft=I**BigInt(256),k=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");var Tt=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),_t=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Nt=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Ot=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),g=class{constructor(t,n,s,i){this.x=t,this.y=n,this.z=s,this.t=i}static fromAffine(t){if(!(t instanceof h))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(h.ZERO)?g.ZERO:new g(t.x,t.y,y,r(t.x*t.y))}static toAffineBatch(t){let n=Zt(t.map(s=>s.z));return t.map((s,i)=>s.toAffine(n[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){lt(t);let{x:n,y:s,z:i}=this,{x:o,y:c,z:a}=t,u=r(n*a),d=r(o*i),w=r(s*a),l=r(c*i);return u===d&&w===l}negate(){return new g(r(-this.x),this.y,this.z,r(-this.t))}double(){let{x:t,y:n,z:s}=this,{a:i}=p,o=r(t**I),c=r(n**I),a=r(I*r(s**I)),u=r(i*o),d=r(r((t+n)**I)-o-c),w=u+c,l=w-a,f=u-c,E=r(d*l),m=r(w*f),v=r(d*f),b=r(l*w);return new g(E,m,b,v)}add(t){lt(t);let{x:n,y:s,z:i,t:o}=this,{x:c,y:a,z:u,t:d}=t,w=r((s-n)*(a+c)),l=r((s+n)*(a-c)),f=r(l-w);if(f===B)return this.double();let E=r(i*I*d),m=r(o*I*u),v=m+E,b=l+w,A=m-E,_=r(v*f),G=r(b*A),D=r(v*A),L=r(f*b);return new g(_,G,L,D)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let n=1+256/t,s=[],i=this,o=i;for(let c=0;c<n;c++){o=i,s.push(o);for(let a=1;a<2**(t-1);a++)o=o.add(i),s.push(o);i=o.double()}return s}wNAF(t,n){!n&&this.equals(g.BASE)&&(n=h.BASE);let s=n&&n._WINDOW_SIZE||1;if(256%s)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=n&&Q.get(n);i||(i=this.precomputeWindow(s),n&&s!==1&&(i=g.normalizeZ(i),Q.set(n,i)));let o=g.ZERO,c=g.ZERO,a=1+256/s,u=2**(s-1),d=BigInt(2**s-1),w=2**s,l=BigInt(s);for(let f=0;f<a;f++){let E=f*u,m=Number(t&d);if(t>>=l,m>u&&(m-=w,t+=y),m===0){let v=i[E];f%2&&(v=v.negate()),c=c.add(v)}else{let v=i[E+Math.abs(m)-1];m<0&&(v=v.negate()),o=o.add(v)}}return g.normalizeZ([o,c])[0]}multiply(t,n){return this.wNAF(C(t,p.l),n)}multiplyUnsafe(t){let n=C(t,p.l,!1),s=g.BASE,i=g.ZERO;if(n===B)return i;if(this.equals(i)||n===y)return this;if(this.equals(s))return this.wNAF(n);let o=i,c=this;for(;n>B;)n&y&&(o=o.add(c)),c=c.double(),n>>=y;return o}isSmallOrder(){return this.multiplyUnsafe(p.h).equals(g.ZERO)}isTorsionFree(){return this.multiplyUnsafe(p.l).equals(g.ZERO)}toAffine(t=W(this.z)){let{x:n,y:s,z:i}=this,o=r(n*t),c=r(s*t);if(r(i*t)!==y)throw new Error("invZ was invalid");return new h(o,c)}fromRistrettoBytes(){j()}toRistrettoBytes(){j()}fromRistrettoHash(){j()}};g.BASE=new g(p.Gx,p.Gy,y,r(p.Gx*p.Gy));g.ZERO=new g(B,y,y,B);function lt(e){if(!(e instanceof g))throw new TypeError("ExtendedPoint expected")}function Y(e){if(!(e instanceof x))throw new TypeError("RistrettoPoint expected")}function j(){throw new Error("Legacy method: switch to RistrettoPoint")}var x=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:n}=p,s=r(k*t*t),i=r((s+y)*Nt),o=BigInt(-1),c=r((o-n*s)*r(s+n)),{isValid:a,value:u}=J(i,c),d=r(u*t);N(d)||(d=r(-d)),a||(u=d),a||(o=s);let w=r(o*(s-y)*Ot-c),l=u*u,f=r((u+u)*c),E=r(w*Tt),m=r(y-l),v=r(y+l);return new g(r(f*v),r(m*E),r(E*v),r(f*m))}static hashToCurve(t){t=H(t,64);let n=$(t.slice(0,32)),s=this.calcElligatorRistrettoMap(n),i=$(t.slice(32,64)),o=this.calcElligatorRistrettoMap(i);return new x(s.add(o))}static fromHex(t){t=H(t,32);let{a:n,d:s}=p,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",o=$(t);if(!zt(z(o),t)||N(o))throw new Error(i);let c=r(o*o),a=r(y+n*c),u=r(y-n*c),d=r(a*a),w=r(u*u),l=r(n*s*d-w),{isValid:f,value:E}=gt(r(l*w)),m=r(E*u),v=r(E*m*l),b=r((o+o)*m);N(b)&&(b=r(-b));let A=r(a*v),_=r(b*A);if(!f||N(_)||A===B)throw new Error(i);return new x(new g(b,A,y,_))}toRawBytes(){let{x:t,y:n,z:s,t:i}=this.ep,o=r(r(s+n)*r(s-n)),c=r(t*n),{value:a}=gt(r(o*c**I)),u=r(a*o),d=r(a*c),w=r(u*d*i),l;if(N(i*w)){let E=r(n*k),m=r(t*k);t=E,n=m,l=r(u*_t)}else l=d;N(t*w)&&(n=r(-n));let f=r((s-n)*l);return N(f)&&(f=r(-f)),z(f)}toHex(){return q(this.toRawBytes())}toString(){return this.toHex()}equals(t){Y(t);let n=this.ep,s=t.ep,i=r(n.x*s.y)===r(n.y*s.x),o=r(n.y*s.y)===r(n.x*s.x);return i||o}add(t){return Y(t),new x(this.ep.add(t.ep))}subtract(t){return Y(t),new x(this.ep.subtract(t.ep))}multiply(t){return new x(this.ep.multiply(t))}multiplyUnsafe(t){return new x(this.ep.multiplyUnsafe(t))}};x.BASE=new x(g.BASE);x.ZERO=new x(g.ZERO);var Q=new WeakMap,h=class{constructor(t,n){this.x=t,this.y=n}_setWindowSize(t){this._WINDOW_SIZE=t,Q.delete(this)}static fromHex(t,n=!0){let{d:s,P:i}=p;t=H(t,32);let o=t.slice();o[31]=t[31]&~128;let c=O(o);if(n&&c>=i)throw new Error("Expected 0 < hex < P");if(!n&&c>=ft)throw new Error("Expected 0 < hex < 2**256");let a=r(c*c),u=r(a-y),d=r(s*a+y),{isValid:w,value:l}=J(u,d);if(!w)throw new Error("Point.fromHex: invalid y coordinate");let f=(l&y)===y;return(t[31]&128)!==0!==f&&(l=r(-l)),new h(l,c)}static async fromPrivateKey(t){return(await V(t)).point}toRawBytes(){let t=z(this.y);return t[31]|=this.x&y?128:0,t}toHex(){return q(this.toRawBytes())}toX25519(){let{y:t}=this,n=r((y+t)*W(y-t));return z(n)}isTorsionFree(){return g.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new h(r(-this.x),this.y)}add(t){return g.fromAffine(this).add(g.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return g.fromAffine(this).multiply(t,this).toAffine()}};h.BASE=new h(p.Gx,p.Gy);h.ZERO=new h(B,y);var Z=class{constructor(t,n){this.r=t,this.s=n,this.assertValidity()}static fromHex(t){let n=H(t,64),s=h.fromHex(n.slice(0,32),!1),i=O(n.slice(32,64));return new Z(s,i)}assertValidity(){let{r:t,s:n}=this;if(!(t instanceof h))throw new Error("Expected Point instance");return C(n,p.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(z(this.s),32),t}toHex(){return q(this.toRawBytes())}};function Pt(...e){if(!e.every(s=>s instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((s,i)=>s+i.length,0),n=new Uint8Array(t);for(let s=0,i=0;s<e.length;s++){let o=e[s];n.set(o,i),i+=o.length}return n}var Kt=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function q(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Kt[e[n]];return t}function yt(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){let s=n*2,i=e.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function dt(e){let t=32,n=e.toString(16).padStart(t*2,"0");return yt(n)}function z(e){return dt(e).reverse()}function N(e){return(r(e)&y)===y}function O(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+q(Uint8Array.from(e).reverse()))}function $(e){return r(O(e)&I**at-y)}function r(e,t=p.P){let n=e%t;return n>=B?n:t+n}function W(e,t=p.P){if(e===B||t<=B)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=r(e,t),s=t,i=B,o=y;for(;n!==B;){let a=s/n,u=s%n,d=i-o*a;s=n,n=u,i=o,o=d}if(s!==y)throw new Error("invert: does not exist");return r(i,t)}function Zt(e,t=p.P){let n=new Array(e.length),s=e.reduce((o,c,a)=>c===B?o:(n[a]=o,r(o*c,t)),y),i=W(s,t);return e.reduceRight((o,c,a)=>c===B?o:(n[a]=r(o*n[a],t),r(o*c,t)),i),n}function S(e,t){let{P:n}=p,s=e;for(;t-- >B;)s*=s,s%=n;return s}function wt(e){let{P:t}=p,n=BigInt(5),s=BigInt(10),i=BigInt(20),o=BigInt(40),c=BigInt(80),u=e*e%t*e%t,d=S(u,I)*u%t,w=S(d,y)*e%t,l=S(w,n)*w%t,f=S(l,s)*l%t,E=S(f,i)*f%t,m=S(E,o)*E%t,v=S(m,c)*m%t,b=S(v,c)*m%t,A=S(b,s)*l%t;return{pow_p_5_8:S(A,I)*e%t,b2:u}}function J(e,t){let n=r(t*t*t),s=r(n*n*t),i=wt(e*s).pow_p_5_8,o=r(e*n*i),c=r(t*o*o),a=o,u=r(o*k),d=c===e,w=c===r(-e),l=c===r(-e*k);return d&&(o=a),(w||l)&&(o=u),N(o)&&(o=r(-o)),{isValid:d||w,value:o}}function gt(e){return J(y,e)}async function tt(...e){let t=await rt.sha512(Pt(...e)),n=O(t);return r(n,p.l)}function zt(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function H(e,t){let n=e instanceof Uint8Array?Uint8Array.from(e):yt(e);if(typeof t=="number"&&n.length!==t)throw new Error(`Expected ${t} bytes`);return n}function C(e,t,n=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(n){if(B<e)return e}else if(B<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function pt(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Ct(e){return O(pt(H(e,32)))}async function V(e){if(e=typeof e=="bigint"||typeof e=="number"?dt(C(e,ft)):H(e),e.length!==32)throw new Error("Expected 32 bytes. Given: "+e.length);let t=await rt.sha512(e),n=pt(t.slice(0,32)),s=t.slice(32,64),i=r(O(n),p.l),o=h.BASE.multiply(i),c=o.toRawBytes();return{head:n,prefix:s,scalar:i,point:o,pointBytes:c}}async function et(e){return(await V(e)).pointBytes}async function mt(e,t){e=H(e);let{prefix:n,scalar:s,pointBytes:i}=await V(t),o=await tt(n,e),c=h.BASE.multiply(o),a=await tt(c.toRawBytes(),i,e),u=r(o+a*s,p.l);return new Z(c,u).toRawBytes()}async function ht(e,t,n){t=H(t),n instanceof h||(n=h.fromHex(n,!1));let{r:s,s:i}=e instanceof Z?e.assertValidity():Z.fromHex(e),o=g.BASE.multiplyUnsafe(i),c=await tt(s.toRawBytes(),n.toRawBytes(),t),a=g.fromAffine(n).multiplyUnsafe(c);return g.fromAffine(s).add(a).subtract(o).multiplyUnsafe(p.h).equals(g.ZERO)}async function Jt(e,t){let{head:n}=await V(e),s=h.fromHex(t).toX25519();return nt.scalarMult(n,s)}h.BASE._setWindowSize(8);function X(e,t,n){let s=r(e*(t-n));return t=r(t-s),n=r(n+s),[t,n]}function Mt(e,t){let{P:n}=p,s=C(e,n),i=C(t,n),o=BigInt(121665),c=s,a=y,u=B,d=s,w=y,l=B,f;for(let b=BigInt(255-1);b>=B;b--){let A=i>>b&y;l^=A,f=X(l,a,d),a=f[0],d=f[1],f=X(l,u,w),u=f[0],w=f[1],l=A;let _=a+u,G=r(_*_),D=a-u,L=r(D*D),ot=G-L,Ut=d+w,Rt=d-w,it=r(Rt*_),ct=r(Ut*D);d=r((it+ct)**I),w=r(c*(it-ct)**I),a=r(G*L),u=r(ot*(G+r(o*ot)))}f=X(l,a,d),a=f[0],d=f[1],f=X(l,u,w),u=f[0],w=f[1];let{pow_p_5_8:E,b2:m}=wt(u),v=r(S(E,BigInt(3))*m);return r(a*v)}function Gt(e){return z(r(e,p.P))}function Dt(e){let t=H(e,32);return t[31]&=127,O(t)}var nt={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(e,t){let n=Dt(t),s=Ct(e),i=Mt(n,s);if(i===B)throw new Error("Invalid private or public key received");return Gt(i)},scalarMultBase(e){return nt.scalarMult(e,nt.BASE_POINT_U)}},P={node:Ht,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},rt={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:q,getExtendedPublicKey:V,mod:r,invert:W,hashToPrivateScalar:e=>{if(e=H(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let t=r(O(e),p.l);if(t===B||t===y)throw new Error("Invalid private key");return t},randomBytes:(e=32)=>{if(P.web)return P.web.getRandomValues(new Uint8Array(e));if(P.node){let{randomBytes:t}=P.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>rt.randomBytes(32),sha512:async e=>{if(P.web){let t=await P.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(t)}else{if(P.node)return Uint8Array.from(P.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=h.BASE){let n=t.equals(h.BASE)?t:new h(t.x,t.y);return n._setWindowSize(e),n.multiply(I),n}};var U;document.addEventListener("DOMContentLoaded",()=>{U=document.getElementById("KeyOpts"),document.getElementById("GenRandKeyPairBtn").addEventListener("click",qt),document.getElementById("GenKeyPairBtn").addEventListener("click",Vt),document.getElementById("SignBtn").addEventListener("click",Ft),document.getElementById("VerifyBtn").addEventListener("click",Lt)});async function qt(){let e=crypto.getRandomValues(new Uint8Array(32)),t=await M(e);U.value==="Hex"?e=t:e=await St(e),await bt(e),Bt(await st("SHA-256",t))}async function Vt(){let e=document.getElementById("Seed").value;if(R(e)){console.debug("Seed is empty... seeing if private key is already set.");let t=await Et();return console.debug(t),t===null,void 0}await bt(e),U.value!=="Hex"&&(e=K(e)),Bt(await st("SHA-256",e))}async function Ft(){let e=await Et(),t=await It();if(e===null||t===null)return;let n=await mt(t,e);if(!At(n))return;let s=await M(n);if(R(s)||s.length%2===1){console.error("input is invalid Hex");return}document.getElementById("HexSig").textContent=s,document.getElementById("B64Sig").textContent=await F(s),xt(document.getElementById("Signature"),s)}async function Lt(){let e=!1,t="Invalid Signature",n=document.getElementById("Signature").value,s=await Xt();if(!R(n)&&At(s))try{e=await ht(s,await It(),await Wt())}catch(i){console.error(i),e=!1}finally{e&&(t="Valid Signature")}document.getElementById("ValidSignature").textContent=t}async function Bt(e){let t=await F(e),n=await M(await et(new Uint8Array(await T(e)))),s=await F(n);document.getElementById("HexPriKey").textContent=e,document.getElementById("B64PriKey").textContent=t,document.getElementById("HexPubKey").textContent=n,document.getElementById("B64PubKey").textContent=s;let i,o;U.value==="Hex"?(i=e,o=n):(i=t,o=s),document.getElementById("PublicKey").value=o,document.getElementById("PrivateKey").value=i}async function Et(){let e=document.getElementById("PrivateKey").value;return R(e)?(console.error("Private key is empty."),null):(U.value!=="Hex"&&(e=K(e)),new Uint8Array(await T(e)))}async function Wt(){let e=document.getElementById("PublicKey").value;if(R(e)){console.debug("PublicKey is empty... Attempting to derive from private key.");let t=document.getElementById("PrivateKey").value;if(R(t)){console.debug("PrivateKey is empty... Attempting to derive from the seed.");let n=document.getElementById("Seed").value;if(R(n))return console.error("Seed is empty."),null;U.value!=="Hex"&&(n=K(n)),e=await M(await vt(await st("SHA-256",n)))}else e=await M(await vt(t))}return U.value!=="Hex"&&(e=K(e)),new Uint8Array(await T(e))}async function vt(e){let t;return U.value==="Hex"?t=await T(e):t=await T(K(e)),await et(new Uint8Array(t))}async function Xt(){let e=document.getElementById("Signature").value;return R(e)?(console.error("Signature is empty."),null):(U.value!=="Hex"&&(e=K(e)),new Uint8Array(await T(e)))}async function It(){let e=document.getElementById("InputMsg").value,t=new Uint8Array;if(!R(e))switch(document.getElementById("MsgOpts").value){case"B64":t=new Uint8Array(await T(K(e)));break;case"Hex":t=new Uint8Array(await T(e));break;case"Text":t=new TextEncoder("utf-8").encode(e);break;default:return console.error("unsupported message encoding"),null}return t}async function bt(e){let t,n;U.value!=="Hex"?(t=e,e=K(e),n=e):(n=e,t=await F(e)),document.getElementById("B64Seed").textContent=t,document.getElementById("HexSeed").textContent=n,xt(document.getElementById("Seed"),e)}async function xt(e,t){if(U.value==="Hex"){e.value=t;return}e.value=await F(t)}function At(e){return R(e.byteLength)||e.byteLength!==64?(console.error("Invalid Signature length"),!1):!0}function K(e){let t=Yt(e),n=atob(t),s="";for(let i=0;i<n.length;i++){let o=n.charCodeAt(i).toString(16).toUpperCase();s+=o.length===2?o:"0"+o}return s}function Yt(e){return e.replace(/-/g,"+").replace(/_/g,"/")}async function F(e){let t=await T(e);return await St(t)}function jt(e){return e.replace(/\+/g,"-").replace(/\//g,"_")}function Qt(e){return e.replace(/=/g,"")}function St(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return Qt(jt(btoa(t)))}async function st(e,t){if(R(e))throw new Error("No hash algorithm specified");return M(await crypto.subtle.digest(e,await T(t)))}async function T(e){if(typeof e!="string")throw new TypeError("base_convert.HexToArrayBuffer: Expected input to be a string");if(e.length%2!==0)throw new RangeError("base_convert.HexToArrayBuffer: Expected string to be an even number of characters");for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)t[n/2]=parseInt(e.substring(n,n+2),16);return t.buffer}async function M(e){return[...new Uint8Array(e)].map(t=>t.toString(16).padStart(2,"0")).join("").toUpperCase()}function R(e){return typeof e=="function"?!1:e===Object(e)?Object.keys(e).length===0:!$t(e)}function $t(e){return!(e===!1||e==="false"||e===void 0||e==="undefined"||e===""||e===0||e==="0"||e===null||e==="null"||e==="NaN"||Number.isNaN(e)||e===Object(e))}export{p as CURVE,g as ExtendedPoint,qt as GenRadomKeyPairGUI,Vt as KeyFromSeedGUI,h as Point,x as RistrettoPoint,Ft as SignMsgGUI,Z as Signature,Lt as VerifySigGUI,q as bytesToHex,nt as curve25519,V as getExtendedPublicKey,et as getPublicKey,Jt as getSharedSecret,mt as sign,rt as utils,ht as verify};
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
//# sourceMappingURL=ed.min.js.map
